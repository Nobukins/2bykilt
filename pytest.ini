[pytest]
# Default options: fail fast on first error, collect coverage for src/, and emit XML + terminal reports
addopts = --maxfail=1 --cov=src --cov-report=xml --cov-report=term --timeout=30
# Discover tests only under tests/ to avoid duplicate root-level test modules
testpaths = tests

# Ignore temp/virtualenv and VCS dirs during discovery
# Ignore problem directories during collection (relative to invocation CWD)
norecursedirs = tmp tmp/* venv .venv .git node_modules ../tmp ../tmp/* ../venv ../.venv fixtures tests/fixtures

# For design-phase PR #80 we temporarily broaden async handling to auto to reduce loop teardown noise.
asyncio_mode = auto
# Set default fixture loop scope to avoid deprecation warning
asyncio_default_fixture_loop_scope = function

# Register markers for selective test execution
markers =
	ci_safe: Tests safe to run in CI - fully mocked or using Playwright headless Chromium (no user profiles/data)
	local_only: Tests requiring local environment - interactive UI, user profiles, Edge browser, or macOS-specific paths
	logging_spec: Design-phase logging contract tests only (temporary for Issue #31)
	integration: Heavy integration tests (network/browser) that should be run separately
