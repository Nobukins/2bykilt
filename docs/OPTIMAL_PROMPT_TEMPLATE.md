# 最適化されたプロンプトテンプレート

## 今回の作業の振り返り

### 実際に行った作業
1. LLMモジュールをオプショナル化
2. 事前登録コマンドの実行機能実装
3. 複数のアクションタイプサポート追加
4. スクリプト実行機能の統合

### 効率的だった点
- 具体的な要件とエラーメッセージの提示
- 段階的な実装とテスト
- コードの構造理解を先行

### 改善できた点
- 初期の要件定義がより具体的であればよかった
- 既存のコード構造の事前調査
- テストケースの明確化

## 最適化されたプロンプト例

### パターン1: 機能のオプショナル化
```
【タスク】: [プロジェクト名]で[依存モジュール名]をオプショナル化し、[代替機能]で動作するように修正

【要件】:
1. [依存モジュール]の条件付きインポート実装
2. [環境変数名]による機能の有効/無効制御
3. 無効時の代替機能実装（[具体的な代替手法]）
4. 既存の[機能A、機能B、機能C]は無効時も動作維持

【制約条件】:
- 既存のAPIインターフェースは変更しない
- [特定のファイル群]の動作は保持
- パフォーマンスの劣化は最小限に

【成功基準】:
- [環境変数]=false時に[具体的なテストケース]が動作
- [特定のコマンド例]が期待通りに実行される
- エラーハンドリングが適切

【実装方針】:
1. まず既存コードの依存関係を調査
2. 条件付きインポート実装
3. フォールバック機能実装
4. 段階的テストで検証
```

### パターン2: スクリプト実行システムの統合
```
【タスク】: [複数のアクションタイプ]のスクリプト実行を統一システムで処理

【対象タイプ】:
- [タイプA]: [説明と要件]
- [タイプB]: [説明と要件]  
- [タイプC]: [説明と要件]

【統合要件】:
1. [既存のスクリプトマネージャー]を活用
2. パラメータ置換システム（${params.name}形式）
3. 非同期実行とリアルタイム出力
4. エラーハンドリングと結果返却

【テストケース】:
- [具体的なコマンド例1]
- [具体的なコマンド例2]
- [エラーケース例]

【期待結果】:
- 全アクションタイプが統一インターフェースで実行
- LLM依存なしで動作
- 適切なログとエラー報告
```

### パターン3: レガシーシステムとの互換性維持
```
【タスク】: [新機能]実装時に[既存システム]との完全互換性を維持

【互換性要件】:
1. 既存の[API/UI/設定]は変更なし
2. [既存の設定ファイル形式]サポート継続
3. [既存のコマンド群]は同じ動作

【検証項目】:
- [既存テストスイート]がすべてパス
- [本番環境での動作]シミュレーション
- [ユーザーワークフロー]の非破壊的動作

【実装指針】:
1. 新機能は追加のみ、削除・変更は避ける
2. 設定の前方互換性確保
3. 段階的ロールアウト可能な設計
```

## 今後の依頼で含めるべき情報

### 必須情報
1. **明確な成功基準**: 「○○ができる」ではなく「○○コマンドを実行して××の結果が得られる」
2. **具体的なテストケース**: 実際に試せるコマンドやシナリオ
3. **制約条件**: 変更してはいけないもの、保持すべき動作
4. **既存システムの理解度**: どの部分を調査から始めるか

### 効率化のポイント
1. **段階的アプローチの明示**: 「まず調査、次に実装、最後にテスト」
2. **優先順位の明確化**: 必須機能と Nice-to-have の区別
3. **エラーケースの事前想定**: よくある失敗パターンの回避策
4. **検証方法の具体化**: 動作確認の手順と期待結果

### より良い結果のための工夫
1. **既存コードの構造理解を最初に**: 実装前の十分な調査時間確保
2. **小さな変更での検証**: 大きな変更前の動作確認
3. **代替案の検討**: 主要アプローチが困難な場合のプランB
4. **ドキュメント化**: 変更内容と使用方法の明確な記録

## 今回の作業に最適化されたプロンプト例

```
【タスク】: 2bykiltプロジェクトでLLM依存を完全にオプショナル化し、事前登録コマンドによるブラウザ自動化を実現

【要件】:
1. ENABLE_LLM環境変数による機能制御
2. LLM無効時もllms.txtの事前登録コマンド(@で始まる)は実行可能
3. 全アクションタイプ(browser-control, script, action_runner_template, git-script)をサポート
4. パラメータ抽出とスクリプト実行の統一システム

【制約】:
- 既存のUI/APIインターフェースは保持
- LLM有効時の動作は変更しない
- requirements.txtとは別にrequirements-minimal.txtを提供

【テストケース】:
- ENABLE_LLM=false環境で`@search-linkedin query=test`が実行される
- 各アクションタイプが適切に処理される
- エラー時の適切なメッセージ表示

【実装方針】:
1. 依存関係の調査とマッピング
2. 条件付きインポートの実装
3. standalone評価機能の実装
4. script_managerとの統合
5. 段階的テストによる検証

【成功基準】:
- minimal環境でブラウザ自動化が動作
- 全事前登録コマンドが実行可能
- 適切なエラーハンドリング
```
